<div><div class="form-group has-tips manual" plug="widget" ld="error-root"><div ld="display" data-display="block"><label class="d-flex align-items-end flex-wrap"><div><span ld="label"></span><span class="text-danger ml-2" ld="is-required">*</span></div><div class="flex-grow-1"></div><div class="m-edit"><div class="mf-note text-sm" ld="limitation"></div></div></label></div><div class="text-sm text-muted"><div ld="desc" style="margin:-.6em 0 .7em"></div></div><div class="m-edit" ld="input"><div><label class="mr-3 mb-2 clickable" ld-each="option"><input class="mr-1" ld="checkbox" type="checkbox"><span ld="text"></span></label></div><div ld="other"><label class="clickable d-flex align-items-center"><input class="mr-1" ld="other-check" type="checkbox"><div class="mr-2 text-nowrap" ld="other-prompt"></div><input class="form-control form-control-sm" type="text" ld="other-text"></label></div><div class="hover-tip tip-sm"><div ld-each="error"></div></div></div><div class="m-edit"><div class="mf-note text-sm mt-2 note" ld-each="note"></div></div><div class="m-view" ld="content"></div></div><script type="@plotdb/block">var mod;module.exports={pkg:{name:"@makeform/checkbox",extend:{name:"@makeform/common"},i18n:{en:{"其它":"Other"},"zh-TW":{"其它":"其它"}}},init:function(e){return e.pubsub.fire("subinit",{mod:mod(e)})}};mod=function(e){var i,t,n,r,o,u,l,a,c,f,d,h,s;i=e.root,t=e.ctx,n=e.data,r=e.parent,o=e.t,u=e.i18n;l=t.ldview;a={value:{list:[],other:{enabled:false,text:""}}};c="_"+Math.random().toString(36).substring(2);f=function(e){if(typeof e==="object"){return e.value}else{return e}};d=function(e){if(typeof e==="object"){return o(e.label)}else{return o(e)}};h=function(t){var e;e=(a.values||[]).filter(function(e){return f(e)===t})[0];e=e&&e.label?e.label:e;return e?o(e):t};s=function(e){return in$(e,(a.values||[]).map(function(e){return f(e)}))};return{init:function(e){var t,u,n,r=this;t=function(){var e;a.other=(e=r.mod.info.config).other||(e.other={});return a.values=(r.mod.info.config||{}).values||[]};t();this.on("meta",function(){return t()});this.on("change",function(e){var t;a.value=e||{};a.value.list=((t=a.value).list||(t.list=[])).filter(function(e){return s(e)});return r.mod.child.view.render(["input","option","other-text","other-check"])});u=function(e){var t;e==null&&(e={});if(!a.value){a.value={}}if(e.list!=null){a.value.list=e.list}a.value.list=a.value.list.filter(function(e){return s(e)});if(e.other){if(e.other.enabled!=null){((t=a.value).other||(t.other={})).enabled=e.other.enabled}if(e.other.text!=null){((t=a.value).other||(t.other={})).text=e.other.text}}return r.value(a.value)};return this.mod.child.view=n=new l({root:i,action:{click:{"other-check":function(e){var t;t=e.node;return u({other:{enabled:!!t.checked}})}},input:{"other-text":function(e){var t;t=e.node;return u({other:{text:t.value}})}}},text:{content:function(e){var t;t=e.node;if(r.isEmpty()){return"n/a"}else{return(r.content()||[]).map(function(e){return h(e)}).join(", ")||"n/a"}},"other-prompt":function(e){var t,n;t=e.node;if(n=(a.other||{}).prompt){return o(n)}else{return o("其它")}}},handler:{input:function(e){var t;t=e.node;return t.classList.toggle("text-danger",r.status()===2)},other:function(e){var t;t=e.node;return t.classList.toggle("d-none",!a.other.enabled)},"other-check":function(e){var t,n;t=e.node;if(!r.mod.info.meta.readonly){t.removeAttribute("disabled")}else{t.setAttribute("disabled",null)}return t.checked=!!((n=a.value||(a.value={})).other||(n.other={})).enabled},"other-text":function(e){var t,n;t=e.node;if(!r.mod.info.meta.readonly){t.removeAttribute("readonly")}else{t.setAttribute("readonly",null)}return t.value=((n=a.value||(a.value={})).other||(n.other={})).text||""},option:{list:function(){return a.values||[]},key:function(e){return f(e)},view:{action:{change:{checkbox:function(e){var t,n,r,o;t=e.node,n=e.ctx;r=Array.from(i.querySelectorAll("input[type=checkbox]")).filter(function(e){return!!e.checked}).map(function(e){return e.value});o={list:r};return u(o)}}},handler:{"@":function(e){var t;t=e.node;return t.style.flexBasis=(r.mod.info.config||{}).layout==="block"?"100%":""},checkbox:function(e){var t,n;t=e.node,n=e.ctx;t.setAttribute("name",c);t.setAttribute("value",f(n));t.checked=in$(f(n),(a.value||{}).list||[]);if(!r.mod.info.meta.readonly){return t.removeAttribute("disabled")}else{return t.setAttribute("disabled",null)}}},text:{text:function(e){var t,n;t=e.node,n=e.ctx;return d(n)}}}}}})},render:function(){return this.mod.child.view.render()},isEmpty:function(t){var e,n;e=this.content(t)||[];e=e.filter(function(e){if(s(e)){return true}if(!(t.other||(t.other={})).enabled){return false}return e===t.other.text});n=Array.isArray(e)?!e.length:!e;return n},content:function(e){var t,n;e==null&&(e={});t=e.list||[];n=a.other.enabled&&(e.other||(e.other={})).enabled&&e.other.text?[e.other.text]:[];return t=t.concat(n)}}};function in$(e,t){var n=-1,r=t.length>>>0;while(++n<r)if(e===t[n])return true;return false}</script></div>
